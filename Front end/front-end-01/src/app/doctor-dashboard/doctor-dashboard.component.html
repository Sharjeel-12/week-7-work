<h2>Doctors</h2>
  <div>
    <label for="search-field">Search patient record here</label>
    <br>
    <input
    type="text"
    id="search-field"
    placeholder="Search doctors by ID, name, email, or phone..."
    [searchFilter]="AllDoctors"
    [searchFields]="['doctorID','doctorName','doctorEmail','doctorPhone','specialization']"
    [minChars]="1"
    [showAllWhenEmpty]="true"
    (searchResults)="visibleDoctors = $event"
  />

  </div>
<button (click)="activateForm()" class="section-title" class="add-btn">+Add New Doctor</button>
@if(AddBtnPressed){
<form [formGroup]="addDoctorForm" (ngSubmit)="onSubmit()" id="addDoctorForm" class="doctor-form">
  <div>
    <label for="doctorID">Doctor ID</label><br />
    <input formControlName="doctorID" type="number" id="doctorID" name="doctorID" />
    @if(AddForm['doctorID'].touched && AddForm['doctorID'].invalid){
    <div class="err-msg">Enter a valid doctor ID</div>
    }
  </div>

  <div>
    <label for="doctorName">Doctor Name</label><br />
    <input formControlName="doctorName" type="text" id="doctorName" name="doctorName" />
    @if(AddForm['doctorName'].touched && AddForm['doctorName'].invalid){
    <div class="err-msg">Enter a valid doctor Name</div>
    }
  </div>

  <div>
    <label for="doctorEmail">Doctor Email</label><br />
    <input formControlName="doctorEmail" type="text" id="doctorEmail" name="doctorEmail" />
    @if(AddForm['doctorEmail'].touched && AddForm['doctorEmail'].invalid){
    @if(AddForm['doctorEmail'].errors?.["required"]){
    <div class="err-msg">Username is required</div>
    }
    @if(AddForm['doctorEmail'].errors?.["minlength"]){
    <div class="err-msg">Username must be at least {{AddForm['doctorEmail'].errors?.['minlength'].requiredLength}}
      characters.</div>
    }
    }
  </div>

  <div>
    <label for="doctorPhone">Doctor Phone</label><br />
    <input formControlName="doctorPhone" type="text" id="doctorPhone" name="doctorPhone" />
  </div>

  <div>
    <label for="specialization">Doctor Description</label><br />
    <textarea formControlName="specialization" id="specialization" name="specialization"></textarea>
  </div>

  <div>
    <button [disabled]="!(addDoctorForm.valid)" type="submit">Add Doctor</button>
    <button (click)="deactivateForm()">cancel</button>
  </div>
</form>
}

<!-- Edit button form starts here   -->
@if(EditBtnPressed){
<form [formGroup]="editDoctorForm" (ngSubmit)="onEdit()" id="editDoctorForm" class="doctor-form">
  <div>
    <label for="doctorID">Doctor ID</label><br />
    <input formControlName="doctorID" type="number" id="doctorID" name="doctorID" />
    @if(EditForm['doctorID'].touched && EditForm['doctorID'].invalid){
    <div class="err-msg">Enter a valid doctor ID</div>
    }
  </div>

  <div>
    <label for="visitID">Visit ID</label><br />
    <input formControlName="visitID" type="number" id="visitID" name="visitID" />
    @if(EditForm['doctorName'].touched && EditForm['doctorName'].invalid){
    <div class="err-msg">Enter a valid doctor Name</div>
    }
  </div>

  <div>
    <label for="doctorName">Doctor Name</label><br />
    <input formControlName="doctorName" type="text" id="doctorName" name="doctorName" />
    @if(EditForm['doctorName'].touched && EditForm['doctorName'].invalid){
    <div class="err-msg">Enter a valid doctor Name</div>
    }
  </div>

  <div>
    <label for="doctorEmail">Doctor Email</label><br />
    <input formControlName="doctorEmail" type="text" id="doctorEmail" name="doctorEmail" />
    @if(EditForm['doctorEmail'].touched && EditForm['doctorEmail'].invalid){
    @if(EditForm['doctorEmail'].errors?.["required"]){
    <div class="err-msg">Username is required</div>
    }
    @if(EditForm['doctorEmail'].errors?.["minlength"]){
    <div class="err-msg">Username must be at least {{EditForm['doctorEmail'].errors?.['minlength'].requiredLength}}
      characters.</div>
    }
    }
  </div>

  <div>
    <label for="doctorPhone">Doctor Phone</label><br />
    <input formControlName="doctorPhone" type="text" id="doctorPhone" name="doctorPhone" />
    @if(EditForm['doctorPhone'].touched && EditForm['doctorPhone'].invalid){
    <div class="err-msg">this can't be blank</div>  
    }
  </div>

  <div>
    <label for="specialization">Doctor Description</label><br />
    <textarea formControlName="specialization" id="specialization" name="specialization"></textarea>
  </div>

  <div>
    <button [disabled]="!(editDoctorForm.valid)" type="submit">Edit Doctor Details</button>
    <button (click)="deactivateEditForm()">cancel</button>
  </div>
</form>
}




<table class="doctors-table">
  <thead>
    <tr>
      <th>Doctor ID</th>
      <!-- <th>Visit ID</th> -->
      <th>Doctor Name</th>
      <th>Doctor Email</th>
      <th>Doctor Phone</th>
      <th>Doctor Description</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>

    @for(doctor of AllDoctors; track doctor){
    <tr>
      <td>{{doctor.doctorID}}</td>
      <td>{{doctor.doctorName}}</td>
      <td>{{doctor.doctorEmail}}</td>
      <td>{{doctor.doctorPhone}}</td>
      <td>{{doctor.specialization}}</td>
      <td class="actions">
        <button type="button" class="btn btn-edit" (click)="activateEditForm(doctor)">Edit</button>
        <button type="button" class="btn btn-delete" (click)="deleteAction(doctor.doctorID)">Delete</button>
      </td>
    </tr>
    }
  </tbody>
</table>