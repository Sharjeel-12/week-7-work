import{k as A,m as O,n as f,o as N,p as k,q as C,r as l,s as B,t as $,u as z,v as G,w as U}from"./chunk-MCLKDG7U.js";import{B as D,Ba as E,Da as _,Fa as V,Ga as T,H as x,Ha as P,Ia as M,Ja as i,Ka as e,La as a,M as y,Ma as h,Na as p,Oa as m,Pa as n,Qa as b,R as I,Sa as w,V as S,ba as u,ca as v,qa as d,ra as F}from"./chunk-U35MBERR.js";var q=(()=>{class o{constructor(t){this.http=t,this.apiUrl="http://localhost:49428/api/Visits"}getAllVisits(){return this.http.get(this.apiUrl,{headers:{Authorization:"Bearer "+sessionStorage.getItem("access_token")}})}getVisitById(t){return this.http.get(`${this.apiUrl}/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("access_token")}})}addVisit(t){return this.http.post(this.apiUrl,t,{headers:{Authorization:"Bearer "+sessionStorage.getItem("access_token")}})}updateVisit(t,r){return this.http.put(`${this.apiUrl}/${t}`,r,{headers:{Authorization:"Bearer "+sessionStorage.getItem("access_token")}})}deleteVisit(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("access_token")}})}static{this.\u0275fac=function(r){return new(r||o)(I(A))}}static{this.\u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function L(o,c){if(o&1){let t=h();i(0,"form",5),p("ngSubmit",function(){u(t);let s=m();return v(s.onSubmit())}),i(1,"div")(2,"label",6),n(3,"Visit ID"),e(),a(4,"br")(5,"input",7),e(),i(6,"div")(7,"label",8),n(8,"Visit Type"),e(),a(9,"br")(10,"input",9),e(),i(11,"div")(12,"label",10),n(13,"Visit Type ID"),e(),a(14,"br")(15,"input",11),e(),i(16,"div")(17,"label",12),n(18,"Visit Duration (min)"),e(),a(19,"br")(20,"input",13),e(),i(21,"div")(22,"label",14),n(23,"Visit Date/Time"),e(),a(24,"br")(25,"input",15),e(),i(26,"div")(27,"label",16),n(28,"Visit Fee"),e(),a(29,"br")(30,"input",17),e(),i(31,"div")(32,"button",18),n(33,"Add Visit"),e(),i(34,"button",19),p("click",function(){u(t);let s=m();return v(s.deactivateForm())}),n(35,"cancel"),e()()()}if(o&2){let t=m();_("formGroup",t.addVisitForm),d(32),_("disabled",t.addVisitForm.invalid||t.addVisitForm.pending)}}function Y(o,c){if(o&1){let t=h();i(0,"form",20),p("ngSubmit",function(){u(t);let s=m();return v(s.onEdit())}),i(1,"div")(2,"label",21),n(3,"Visit ID"),e(),a(4,"br")(5,"input",22),e(),i(6,"div")(7,"label",23),n(8,"Visit Type"),e(),a(9,"br")(10,"input",24),e(),i(11,"div")(12,"label",25),n(13,"Visit Type ID"),e(),a(14,"br")(15,"input",26),e(),i(16,"div")(17,"label",27),n(18,"Visit Duration (min)"),e(),a(19,"br")(20,"input",28),e(),i(21,"div")(22,"label",29),n(23,"Visit Date/Time"),e(),a(24,"br")(25,"input",30),e(),i(26,"div")(27,"label",31),n(28,"Visit Fee"),e(),a(29,"br")(30,"input",32),e(),i(31,"div")(32,"button",18),n(33,"Edit Visit"),e(),i(34,"button",19),p("click",function(){u(t);let s=m();return v(s.deactivateEditForm())}),n(35,"cancel"),e()()()}if(o&2){let t=m();_("formGroup",t.editVisitForm),d(32),_("disabled",t.editVisitForm.invalid||t.editVisitForm.pending)}}function J(o,c){if(o&1){let t=h();i(0,"tr")(1,"td"),n(2),e(),i(3,"td"),n(4),e(),i(5,"td"),n(6),e(),i(7,"td"),n(8),e(),i(9,"td"),n(10),e(),i(11,"td"),n(12),e(),i(13,"td",33)(14,"button",34),p("click",function(){let s=u(t).$implicit,g=m();return v(g.activateEditForm(s))}),n(15,"Edit"),e(),i(16,"button",35),p("click",function(){let s=u(t).$implicit,g=m();return v(g.deleteAction(s.visitID))}),n(17,"Delete"),e()()()}if(o&2){let t=c.$implicit,r=m();d(2),b(t.visitID),d(2),b(t.visitType),d(2),b(t.visitTypeID),d(2),b(t.visitDuration),d(2),b(r.displayDate(t.visitDate)),d(2),b(t.visitFee)}}var tt=(()=>{class o{constructor(t){this.visitService=t,this.AllVisits=[],this.AddBtnPressed=!1,this.EditBtnPressed=!1,this.editingId=null}ngOnInit(){this.addVisitForm=new C({visitID:new l(null,[f.required]),visitType:new l(""),visitTypeID:new l(1,[f.required]),visitDuration:new l(null),visitDate:new l(null),visitFee:new l(null)}),this.editVisitForm=new C({visitID:new l(null,[f.required]),visitType:new l(""),visitTypeID:new l(1,[f.required]),visitDuration:new l(null),visitDate:new l(null),visitFee:new l(null)}),this.reloadVisitsAndSetNextId()}activateForm(){this.AddBtnPressed=!0}deactivateForm(){this.AddBtnPressed=!1,this.resetAddFormToNextId()}activateEditForm(t){this.editingId=Number(t.visitID),this.EditBtnPressed=!0,this.editVisitForm.patchValue({visitID:t.visitID??null,visitType:t.visitType??"",visitTypeID:t.visitTypeID??1,visitDuration:t.visitDuration??null,visitDate:K(t.visitDate),visitFee:t.visitFee??null})}deactivateEditForm(){this.EditBtnPressed=!1,this.editVisitForm.reset(),this.editingId=null}onSubmit(){let t=this.addVisitForm.getRawValue(),r={visitID:t.visitID??void 0,visitType:t.visitType??"",visitTypeID:Number(t.visitTypeID??1),visitDuration:Number(t.visitDuration??0),visitDate:j(t.visitDate),visitFee:Number(t.visitFee??0)};this.visitService.addVisit(r).pipe(x(()=>this.visitService.getAllVisits()),D(()=>this.AddBtnPressed=!1)).subscribe({next:s=>{this.AllVisits=s??[],this.resetAddFormToNextId()},error:s=>alert(s)})}onEdit(){if(this.editingId==null)return;let t=this.editVisitForm.getRawValue(),r={visitID:Number(t.visitID),visitType:t.visitType??"",visitTypeID:Number(t.visitTypeID??1),visitDuration:Number(t.visitDuration??0),visitDate:j(t.visitDate),visitFee:Number(t.visitFee??0)};this.visitService.updateVisit(this.editingId,r).pipe(x(()=>this.visitService.getAllVisits()),D(()=>this.deactivateEditForm())).subscribe({next:s=>this.AllVisits=s??[],error:s=>alert(s)})}deleteAction(t){t!=null&&this.visitService.deleteVisit(t).pipe(x(()=>this.visitService.getAllVisits())).subscribe({next:r=>this.AllVisits=r??[],error:r=>alert(r)})}reloadVisitsAndSetNextId(){this.visitService.getAllVisits().subscribe({next:t=>{this.AllVisits=t??[],this.resetAddFormToNextId()},error:t=>alert(t)})}computeNextId(){return this.AllVisits?.length?this.AllVisits.reduce((t,r)=>Math.max(t,Number(r.visitID)||0),0)+1:1}resetAddFormToNextId(){let t=this.computeNextId(),r=this.addVisitForm.get("visitID");r?.setValue(t),r?.setValidators([f.required,f.min(t)]),r?.updateValueAndValidity({emitEvent:!1}),this.addVisitForm.patchValue({visitType:"",visitTypeID:1,visitDuration:null,visitDate:null,visitFee:null}),this.addVisitForm.markAsPristine()}displayDate(t){if(!t)return"\u2014";try{return new Date(t).toLocaleString()}catch{return t}}static{this.\u0275fac=function(r){return new(r||o)(F(q))}}static{this.\u0275cmp=S({type:o,selectors:[["app-visit-dashboard"]],standalone:!0,features:[w],decls:26,vars:2,consts:[[1,"section-title"],[1,"add-btn",3,"click"],["id","addVisitForm",1,"visit-form",3,"formGroup"],["id","editVisitForm",1,"visit-form",3,"formGroup"],[1,"visits-table"],["id","addVisitForm",1,"visit-form",3,"ngSubmit","formGroup"],["for","visitID"],["formControlName","visitID","type","number","id","visitID","name","visitID"],["for","visitType"],["formControlName","visitType","type","text","id","visitType","name","visitType","placeholder","Emergency / Follow-Up / Consultation"],["for","visitTypeID"],["formControlName","visitTypeID","type","number","id","visitTypeID","name","visitTypeID"],["for","visitDuration"],["formControlName","visitDuration","type","number","id","visitDuration","name","visitDuration"],["for","visitDate"],["formControlName","visitDate","type","datetime-local","id","visitDate","name","visitDate"],["for","visitFee"],["formControlName","visitFee","type","number","id","visitFee","name","visitFee"],["type","submit",3,"disabled"],["type","button",3,"click"],["id","editVisitForm",1,"visit-form",3,"ngSubmit","formGroup"],["for","e_visitID"],["formControlName","visitID","type","number","id","e_visitID","name","visitID"],["for","e_visitType"],["formControlName","visitType","type","text","id","e_visitType","name","visitType"],["for","e_visitTypeID"],["formControlName","visitTypeID","type","number","id","e_visitTypeID","name","visitTypeID"],["for","e_visitDuration"],["formControlName","visitDuration","type","number","id","e_visitDuration","name","visitDuration"],["for","e_visitDate"],["formControlName","visitDate","type","datetime-local","id","e_visitDate","name","visitDate"],["for","e_visitFee"],["formControlName","visitFee","type","number","id","e_visitFee","name","visitFee"],[1,"actions"],["type","button",1,"btn","btn-edit",3,"click"],["type","button",1,"btn","btn-delete",3,"click"]],template:function(r,s){r&1&&(i(0,"h2",0),n(1,"Visits"),e(),i(2,"button",1),p("click",function(){return s.activateForm()}),n(3,"+Add New Visit"),e(),E(4,L,36,2,"form",2)(5,Y,36,2,"form",3),i(6,"table",4)(7,"thead")(8,"tr")(9,"th"),n(10,"Visit ID"),e(),i(11,"th"),n(12,"Visit Type"),e(),i(13,"th"),n(14,"Visit Type ID"),e(),i(15,"th"),n(16,"Visit Duration"),e(),i(17,"th"),n(18,"Visit Date"),e(),i(19,"th"),n(20,"Visit Fee"),e(),i(21,"th"),n(22,"Actions"),e()()(),i(23,"tbody"),P(24,J,18,6,"tr",null,T),e()()),r&2&&(d(4),V(4,s.AddBtnPressed?4:-1),d(),V(5,s.EditBtnPressed?5:-1),d(19),M(s.AllVisits))},dependencies:[U,B,O,$,N,k,z,G],styles:[".section-title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:16px;color:#333}.add-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 14px;font-size:16px;cursor:pointer;margin-bottom:20px;border-radius:4px}.add-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.visit-form[_ngcontent-%COMP%]{background-color:#fefefe;border:1px solid #ddd;padding:20px;margin-bottom:30px;border-radius:6px;max-width:550px}.visit-form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:15px}.visit-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;display:block;margin-bottom:5px}.visit-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .visit-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .visit-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;font-size:14px;border:1px solid #ccc;border-radius:4px}.visit-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 16px;margin-right:10px;border:none;border-radius:4px;font-size:14px;cursor:pointer}.visit-form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.visit-form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#a0d6b4;cursor:not-allowed}.visit-form[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.visits-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:20px}.visits-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .visits-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:12px;text-align:left}.visits-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:600}.actions[_ngcontent-%COMP%]{display:flex;gap:10px}.btn[_ngcontent-%COMP%]{padding:6px 12px;font-size:14px;border-radius:4px;cursor:pointer;border:none}.btn-edit[_ngcontent-%COMP%]{background-color:#ffc107;color:#000}.btn-delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#e0a800}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#c82333}"]})}}return o})();function j(o){return o?new Date(o).toISOString():new Date().toISOString()}function K(o){if(!o)return null;let c=new Date(o),t=r=>String(r).padStart(2,"0");return`${c.getFullYear()}-${t(c.getMonth()+1)}-${t(c.getDate())}T${t(c.getHours())}:${t(c.getMinutes())}`}export{tt as a};
